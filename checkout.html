<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - Redstore</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body>
    <div class="container">
        <div class="navbar">
            <div class="logo">
                <a href="index.html"><img src="images/logo.png" width="125px"></a>
            </div>
            <nav>
                <ul id="MenuItems">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="products.html">Products</a></li>
                    <li><a href="about.html">About</a></li>
                    <li><a href="contact.html">Contact</a></li>
                    <li><a href="account.html">Account</a></li>
                </ul>
            </nav>
            <a href="cart.html"><img src="images/cart.png" width="30px" height="30px"></a>
            <img src="images/menu.png" class="menu-icon" onClick="menutoggle()" >
        </div>
    </div>

    <!-- Checkout Section -->
    <div class="account-page">
        <div class="container">
            <div class="row" style="align-items: flex-start;">
                
                <!-- Billing Form -->
                <div class="col-2">
                    <div class="checkout-form">
                        <h2>Billing Details</h2>
                        <form id="checkoutForm" onsubmit="placeOrder(event)">
                            <input type="text" placeholder="Full Name" required>
                            <input type="email" placeholder="Email Address" required>
                            <input type="text" placeholder="Address" required>
                            <input type="text" placeholder="City" required>
                            <div class="row">
                                <div class="col-2" style="min-width: 45%;">
                                    <input type="text" placeholder="State" required>
                                </div>
                                <div class="col-2" style="min-width: 45%;">
                                    <input type="text" placeholder="Zip Code" required>
                                </div>
                            </div>
                            <h2>Payment</h2>
                            <select id="paymentMethod" onchange="togglePaymentFields()">
                                <option value="cod">Cash on Delivery (COD)</option>
                                <option value="card">Credit/Debit Card</option>
                                <option value="upi">UPI</option>
                            </select>
                            
                            <!-- Mock Payment Fields -->
                            <div id="cardDetails" style="display:none;">
                                <input type="text" placeholder="Card Number" maxlength="16">
                                <div class="row">
                                    <input type="text" placeholder="MM/YY" style="width: 45%; margin-right:10px;">
                                    <input type="text" placeholder="CVV" style="width: 45%;">
                                </div>
                            </div>
                            <div id="upiDetails" style="display:none;">
                                <input type="text" placeholder="Enter UPI ID (e.g. name@upi)">
                            </div>

                            <button type="submit" class="btn">Place Order</button>
                        </form>
                    </div>
                </div>

                <!-- Order Summary -->
                <div class="col-2">
                    <div class="checkout-form" style="background: #f9f9f9; border: 1px solid #ddd;">
                        <h2>Order Summary</h2>
                        <div id="orderItems">
                            <!-- Items populated by JS -->
                        </div>
                        <hr style="border:none; border-top:1px solid #ccc; margin:10px 0;">
                        <div style="display:flex; justify-content:space-between;">
                            <strong>Total Amount:</strong>
                            <strong id="finalTotal">₹0.00</strong>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div class="footer">
        <div class="container">
            <hr>
            <p class="copyright">Copyright 2025 - Atharv Pose</p>
        </div>
    </div>

    <script>
        var menuItems = document.getElementById("MenuItems");
        if(window.innerWidth <= 800) { menuItems.style.maxHeight = "0px"; }
        function menutoggle(){
            if(menuItems.style.maxHeight == "0px"){ menuItems.style.maxHeight = "200px"; }
            else{ menuItems.style.maxHeight = "0px"; }
        }

        // --- Load Order Summary ---
        function loadSummary() {
            var cart = JSON.parse(localStorage.getItem("redstore_cart")) || [];
            var container = document.getElementById("orderItems");
            var subtotal = 0;

            if(cart.length === 0) {
                container.innerHTML = "<p>Your cart is empty.</p>";
                return;
            }

            container.innerHTML = "";
            cart.forEach(item => {
                var itemTotal = item.price * item.quantity;
                subtotal += itemTotal;
                container.innerHTML += `
                    <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
                        <span>${item.quantity} x ${item.name} <br><small>(${item.size})</small></span>
                        <span>₹${itemTotal.toLocaleString('en-IN')}</span>
                    </div>
                `;
            });

            var tax = 250;
            var total = subtotal + tax;
            document.getElementById("finalTotal").innerText = "₹" + total.toLocaleString('en-IN');
        }

        function togglePaymentFields() {
            var method = document.getElementById("paymentMethod").value;
            document.getElementById("cardDetails").style.display = method === "card" ? "block" : "none";
            document.getElementById("upiDetails").style.display = method === "upi" ? "block" : "none";
        }

        function placeOrder(e) {
            e.preventDefault();
            var cart = JSON.parse(localStorage.getItem("redstore_cart")) || [];
            
            if(cart.length === 0) {
                alert("Your cart is empty!");
                return;
            }

            // Simulate Processing
            var btn = e.target.querySelector("button");
            var originalText = btn.innerText;
            btn.innerText = "Processing...";
            btn.disabled = true;

            setTimeout(function(){
                alert("Order Placed Successfully! Your Order ID is #" + Math.floor(Math.random() * 1000000));
                
                // Clear Cart
                localStorage.removeItem("redstore_cart");
                
                // Redirect
                window.location.href = "index.html";
            }, 2000);
        }

        loadSummary();
    </script>
</body>
</html>